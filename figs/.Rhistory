library(DelaySSA)
sample <- 10000
k <- c(0.03,0.04,10)
S_matrix=c(-1,1,0,1,-1,0,0,0,1)
S_matrix <- matrix(S_matrix,nrow = 3)
S_matrix_delay <- c(0,0,0,0,0,0,0,0,-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 3)
tmax <- 100
n_initial <- matrix(c(1,0,0),nrow = 3)
t_initial <- 0
delay_type <- matrix(c(0,0,2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,5)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0),nrow = 3)
svg <- svglite("Telegraph_mean.svg", width = 5, height = 5)
library(svglite)
sample <- 10000
k <- c(0.03,0.04,10)
S_matrix=c(-1,1,0,1,-1,0,0,0,1)
S_matrix <- matrix(S_matrix,nrow = 3)
S_matrix_delay <- c(0,0,0,0,0,0,0,0,-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 3)
tmax <- 100
n_initial <- matrix(c(1,0,0),nrow = 3)
t_initial <- 0
delay_type <- matrix(c(0,0,2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,5)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0),nrow = 3)
svg <- svglite("Telegraph_mean.svg", width = 5, height = 5)
setwd("/Users/ziyan/Documents/GitHub/DelaySSA/figs")
sample <- 10000
k <- c(0.03,0.04,10)
S_matrix=c(-1,1,0,1,-1,0,0,0,1)
S_matrix <- matrix(S_matrix,nrow = 3)
S_matrix_delay <- c(0,0,0,0,0,0,0,0,-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 3)
tmax <- 100
n_initial <- matrix(c(1,0,0),nrow = 3)
t_initial <- 0
delay_type <- matrix(c(0,0,2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,5)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0),nrow = 3)
svg <- svglite("Telegraph_mean.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Telegraph_density_100s.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("Telegraph_mean.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Telegraph_density_100s.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
k <- c(0.03,0.04,10)
S_matrix=c(-1,1,0,1,-1,0,0,0,1)
S_matrix <- matrix(S_matrix,nrow = 3)
S_matrix_delay <- c(0,0,0,0,0,0,0,0,-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 3)
tmax <- 100
n_initial <- matrix(c(1,0,0),nrow = 3)
t_initial <- 0
delay_type <- matrix(c(0,0,2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,5)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0),nrow = 3)
result <- simulation_DelaySSA(algorithm = "Direct", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("Telegraph_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Telegraph_density_100s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 1000
k <- c(10)
S_matrix <- c(1)
S_matrix <- matrix(S_matrix,nrow = 1)
S_matrix_delay <- c(-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 1)
tmax <- 20
n_initial <- matrix(c(0),nrow = 1)
t_initial <- 0
delay_type <- matrix(c(2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,5)
product_matrix <- matrix(c(0),nrow = 1)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("BirthDeath_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("BirthDeath_density_20s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
a <- 0.0282
b <- 3.46
j <- 30
k <- c(sapply(1:j, function(i) a * b^i / (1 + b)^(i + 1)))
S_matrix <- c(1:j)
S_matrix <- matrix(S_matrix,nrow = 1)
S_matrix_delay <- -c(1:j)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 1)
tmax <- 200
n_initial <- matrix(c(0),nrow = 1)
t_initial <- 0
delay_type <- matrix(rep(c(2),times=j),nrow = 1)
delaytime_list <- list()
for (i in 1:j) {
delaytime_list <- append(delaytime_list,120)
}
product_matrix <- matrix(rep(0,j),nrow = 1)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("Bursty_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Bursty_density_20s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 1000
S_matrix <- c(1,0,0,-1)
S_matrix <- matrix(S_matrix,nrow = 2)
S_matrix_delay <- c(-1,1,0,0)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 2)
tmax <- 400
n_initial <- matrix(c(0,0),nrow = 2)
t_initial <- 0
delay_type <- matrix(c(2,0),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,20)
delaytime_list <- append(delaytime_list,0)
product_matrix <- matrix(c(0,0,0,1),nrow = 2)
k <- function(n){  k <- c(1/(1 + (n[2])^2), 1/(1 + n[2]))}
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("oscillation_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("oscillation_density_400s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
a <- 0.0282
b <- 3.46
j <- 30
k <- c(sapply(1:j, function(i) a * b^i / (1 + b)^(i + 1)))
S_matrix <- c(1:j)
S_matrix <- matrix(S_matrix,nrow = 1)
S_matrix_delay <- -c(1:j)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 1)
tmax <- 200
n_initial <- matrix(c(0),nrow = 1)
t_initial <- 0
delay_type <- matrix(rep(c(2),times=j),nrow = 1)
delaytime_list <- list()
for (i in 1:j) {
delaytime_list <- append(delaytime_list,120)
}
product_matrix <- matrix(rep(0,j),nrow = 1)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("Bursty_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Bursty_density_200s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 5
k <- c(1e-4,1e-2)
S_matrix=c(-1,1,0,0,0,0,-1,1)
S_matrix <- matrix(S_matrix,nrow = 4)
S_matrix_delay <- c(0,-1,1,0,0,0,0,0)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 4)
tmax <- 400
n_initial <- matrix(c(999,0,1,0),nrow = 4)
t_initial <- 0
delay_type <- matrix(c(2,0),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,20)
delaytime_list <- append(delaytime_list,0)
product_matrix <- matrix(c(1,0,1,0,0,0,1,0),nrow = 4)
result <- simulation_DelaySSA(algorithm = "Direct", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("SIR_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("SIR_density_400s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 5
k <- c(1e-4,1e-2)
S_matrix=c(-1,1,0,0,0,0,-1,1)
S_matrix <- matrix(S_matrix,nrow = 4)
S_matrix_delay <- c(0,-1,1,0,0,0,0,0)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 4)
tmax <- 400
n_initial <- matrix(c(999,0,1,0),nrow = 4)
t_initial <- 0
delay_type <- matrix(c(2,0),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,20)
delaytime_list <- append(delaytime_list,0)
product_matrix <- matrix(c(1,0,1,0,0,0,1,0),nrow = 4)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("SIR_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("SIR_density_400s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 5000
k <- c(10,1)
S_matrix=c(1,-1)
S_matrix <- matrix(S_matrix,nrow = 1)
S_matrix_delay <- c(-1,0)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 1)
tmax <- 50
n_initial <- matrix(c(0),nrow = 1)
t_initial <- 0
delay_type <- matrix(c(2,0),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,5)
delaytime_list <- append(delaytime_list,0)
product_matrix <- matrix(c(0,1),nrow = 1)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("DelayIneterrupt1_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("DelayIneterrupt1_density_50s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
k <- c(2,0.1,0.5,0.1)
S_matrix=c(1,0,-1,0,-1,1,0,-1)
S_matrix <- matrix(S_matrix,nrow = 2)
S_matrix_delay <- c(0,0,0,0,0,-1,0,0)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 2)
tmax <- 50
n_initial <- matrix(c(0,0),nrow = 2)
t_initial <- 0
delay_type <- matrix(c(0,0,2,0),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,15)
delaytime_list <- append(delaytime_list,0)
product_matrix <- matrix(c(0,0,1,0,1,0,0,1),nrow = 2)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("DelayIneterrupt2_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("DelayIneterrupt2_density_50s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
j=40
a=0.0282
b=3.46
k <- c(sapply(1:j, function(i) a * b^i / (1 + b)^(i + 1)),1/120)
S_matrix=c(1:j,-1)
S_matrix <- matrix(S_matrix,nrow = 1)
tmax <- 1000
t_initial <- 0
n_initial <- matrix(0,nrow = 1)
n_initial <- matrix(n_initial,nrow = 1)
product_matrix <- matrix(c(rep(0,j),1),nrow = 1)
result <- simulation_DelaySSA(algorithm = "Direct", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, k=k, product_matrix=product_matrix)
svg <- svglite("Bursty_nodelay_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Bursty_nodelay_density_1000s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
k <- c(30,1)
S_matrix <- c(1, -1)
S_matrix <- matrix(S_matrix,nrow = 1)
tmax <- 10
n_initial <- matrix(c(0),nrow = 1)
t_initial <- 0
product_matrix <- matrix(c(0,1),nrow = 1)
result <- simulation_DelaySSA(algorithm = "Direct", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, k=k, product_matrix=product_matrix)
svg <- svglite("Birthdeath_nodelay_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Birthdeath_nodelay_density_10s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
k <- c(0.03,0.04,10,1)
S_matrix=c(-1,1,0,1,-1,0,0,0,1,0,0,-1)
S_matrix <- matrix(S_matrix,nrow = 3)
tmax <- 100
t_initial <- 0
n_initial <- c(1,0,0)
n_initial <- matrix(n_initial,nrow = 3)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0,0,0,1),nrow = 3)
result <- simulation_DelaySSA(algorithm = "Direct", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, k=k, product_matrix=product_matrix)
svg <- svglite("Telegraph_nodelay_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Telegraph_nodelay_density_1000s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
sample <- 10000
k <- c(0.03,0.04,10)
S_matrix=c(-1,1,0,1,-1,0,0,0,1)
S_matrix <- matrix(S_matrix,nrow = 3)
S_matrix_delay <- c(0,0,0,0,0,0,0,0,-1)
S_matrix_delay <- matrix(S_matrix_delay,nrow = 3)
tmax <- 100
n_initial <- matrix(c(1,0,0),nrow = 3)
t_initial <- 0
delay_type <- matrix(c(0,0,2),nrow = 1)
delaytime_list <- list()
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,0)
delaytime_list <- append(delaytime_list,5)
product_matrix <- matrix(c(1,0,0,0,1,0,0,1,0),nrow = 3)
result <- simulation_DelaySSA(algorithm = "DelayMNR", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
svg <- svglite("Telegraph_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
dev.off()
svg <- svglite("Telegraph_density_100s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
dev.off()
result <- simulation_DelaySSA(algorithm = "DelayDirect", sample_size=sample, tmax=tmax, n_initial=n_initial, t_initial=t_initial, S_matrix=S_matrix, S_matrix_delay=S_matrix_delay, k=k, product_matrix=product_matrix, delay_type=delay_type , delaytime_list=delaytime_list)
# svg <- svglite("Telegraph_mean_exp.svg", width = 5, height = 5)
plot_SSA_mean(result = result,t=seq(0, tmax, by = 1) ,n_initial = n_initial,t_initial = 0)
# dev.off()
# svg <- svglite("Telegraph_density_100s_exp.svg", width = 5, height = 5)
plot_SSA_density(result = result,t_pick = tmax)
